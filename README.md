# ordersControl
Итоговая тестовая работа 

## Цель работы
Разработать и развернуть приложение для учёта заказов, используя PostgreSQL.
Приложение должно включать:
   1. Создание и миграцию схемы БД (DDL + тестовые данные).
   2. Набор SQL-запросов на чтение/изменение/удаление.
   3. Java-приложение на Maven, которое подключается к этой БД через JDBC и
   выполняет базовые операции CRUD, выводя результаты в консоль.

##   Задача 1. Установка и настройка PostgreSQL готово
1. Рекомендована 12 версия PostgreSQL. Установить PostgreSQL на
   локальную машину https://postgrespro.ru/docs/postgrespro/14/binary-installation-on-windows 
или использовать Docker-контейнер. **(готово)**
2. Проверить подключение к PostgreSQL из IDE Intellij Idea
   https://www.jetbrains.com/help/idea/postgresql.html#connect-to-postgresql-database
**(готово)**

## Задача 2. Проектирование и создание схемы БД готово
1. Файл schema.sql должен содержать:  
   - Таблицы:
     * product — id, описание, стоимость, количество, категория. **(готово)**
     * customer — id, имя, фамилия, телефон, email. **(готово)**
     * order — id, product_id (FK), customer_id (FK), дата заказа, количество, статус. **(готово)**
     * order_status — справочник статусов заказов (id, имя статуса). **(готово)**
   - Первичные и внешние ключи, ограничения NOT NULL, CHECK (например, цена ≥ 0, количество ≥ 0). **(готово)**
   - Индексы по внешним ключам и дате заказа. **(готово)**
   - Комментарии к таблицам и ключевым полям. **(готово)**
   - CREATE TABLE IF NOT EXISTS, чтобы скрипт можно было запускать повторно. **(готово)**
2. Заполнение тестовыми данными — минимум 10 строк в каждой таблице. **(готово)**
   - Схема данных может быть выбрана любой на усмотрение студента. Можно проявить фантазию и создать 
   Базу Данных на ваш лад.
     
## Задача 3. SQL-запросы готово
 Создать файл test-queries.sql, включающий не менее 10 запросов: **(готово)** (находится в src/main/resources/db)
 - 5 запросов на чтение (в том числе JOIN с несколькими таблицами, агрегаты, сортировка, фильтрация).

       1) Получение списка товаров доступных для заказа (готво)
       2) Получение всех заказов клиента (join с таблицами products, customers и order_statuses) (готово)
       3) Получение статистики клиента (join с таблицами order_statuses и customers) (готово)
       4) Топ-3 самых популярных товара. (готово)
       5) 
 - 3 запроса на изменение (UPDATE).
      
       1) Обновить статус заказа
       2) Обновление количества на складе при покупке.
       3) Обновление телефона клиента
 - 2 запроса на удаление (DELETE).

       1) Удаление продукта (закончился на складе)
       2) Удаление клиента

## Задача 4. Java-приложение (Maven, без Spring)
1. Создать Maven-проект (Java 17) с зависимостями:
   - PostgreSQL JDBC Driver **(готово)**
   - (опционально) Flyway для миграций **(готово)**
2. Реализовать класс App.java, который: 
   - Подключается к БД через JDBC (DriverManager). **(готово)**
   - Выполняет автоматический запуск миграций (если используется Flyway). **(готово)**
   - Демонстрирует CRUD-операции:
     1. Вставка нового товара и покупателя (PreparedStatement).
     2. Создание заказа для покупателя.
     3. Чтение и вывод последних 5 заказов с JOIN на товары и покупателей.
     4. Обновление цены товара и количества на складе.
     5. Удаление тестовых записей.
   - Работает в транзакции с commit() и rollback() при ошибках.
   - Выводит результаты операций в консоль в удобочитаемом формате.
3. Параметры подключения (URL, user, password) вынести в application.properties **готово**

## Результат
1. Репозиторий на GitHub (ветка + Pull Request).
2. Скриншоты:
   - Установка/подключение PostgreSQL. **готово**
   - Выполнение миграций. **готово**
   - ER-диаграмма или схема БД. **готово**
   - Запуск Java-приложения и вывод CRUD-операций.
   - Результаты выполнения test-queries.sql в IDE. **готово**
